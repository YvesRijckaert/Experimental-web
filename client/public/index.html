<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="author" content="Yves Rijckaert Arthur Segaert" />
    <meta name="description" content="Spotify Playlist Artwork Generator" />
    <title>Spotify Playlist Artwork Generator</title>
  </head>
  <body>
    <div id="root"></div>
    <canvas id="c"></canvas>
    <script id="vertex-shader" type="x-shader/x-vertex">
      attribute vec2 a_texCoord;
      attribute vec2 a_position;
      uniform mat3 u_matrix;
      varying vec2 v_texCoord;
      void main() {
        vec2 location = (u_matrix * vec3(a_position, 1)).xy;
        gl_Position = vec4(location, 0, 1);
        v_texCoord = a_texCoord;
      }
    </script>
    <script id="fragment-shader" type="x-shader/x-fragment">
      precision mediump float;
      uniform sampler2D u_image;
      uniform float u_time;
      varying vec2 v_texCoord;
      void main() {
        float offset = (u_time - floor(u_time)) / u_time;
        float currentTime = (u_time) * (offset);
        vec3 waveParams = vec3(10.0, 0.8, 0.1 );
        vec2 waveCentre = vec2(0.5, 0.5);
        vec2 texCoord = vec2(v_texCoord.x, v_texCoord.y);
        float dist = distance(texCoord, waveCentre);
        vec4 color = texture2D(u_image, texCoord);
        if ((dist <= ((currentTime) + (waveParams.z))) && (dist >= ((currentTime) - (waveParams.z))))
        {
          float diff = (dist - currentTime);
          float scaleDiff = (1.0 - pow(abs(diff * waveParams.x), waveParams.y));
          float diffTime = (diff  * scaleDiff);
          vec2 diffTexCoord = normalize(texCoord - waveCentre);
          texCoord += ((diffTexCoord * diffTime) / (currentTime * dist * 40.0));
          color = texture2D(u_image, texCoord);
          color += (color * scaleDiff) / (currentTime * dist * 40.0);
        }
        gl_FragColor = color;
      }
    </script>
    <script src="js/m3.js"></script>
    <script src="js/script.js"></script>
  </body>
</html>
